<!-- ... (start of your existing index.html unchanged) ... -->
<head>
  ...
  <!-- съществуващи meta и стилове -->

  <!-- СТАТИЧЕН манифест и iOS icon -->
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" sizes="180x180">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#071029">
  ...
</head>
<body>
  ...
  <header class="flex items-center gap-4">
    ...
    <div>
      <h1 class="text-white font-heading text-2xl leading-tight">DualPay Calculator</h1>
      <p class="text-slate-300 text-sm mt-0.5">PWA • Ресто в BGN & EUR — Автор: Калоян Горанов</p>
    </div>

    <!-- Install button (по подразбиране скрит) -->
    <div class="ml-auto">
      <button id="install-btn" class="hidden rounded-lg px-3 py-2 text-sm bg-indigo-600/90 hover:bg-indigo-500">Инсталирай</button>
    </div>
  </header>

  ... (останалата част от HTML) ...

  <script>
    // --- Запази целия твой съществуващ JS без частта, която генерира manifestBlob и регистрира SW чрез Blob
    // --- Тук добавям само PWA helper: beforeinstallprompt + register SW

    let deferredPrompt;
    const installBtn = document.getElementById('install-btn');

    window.addEventListener('beforeinstallprompt', (e) => {
      // предотвратяваме автоматичното изскачане
      e.preventDefault();
      deferredPrompt = e;
      // покажи бутон
      if (installBtn) installBtn.classList.remove('hidden');
    });

    if (installBtn) {
      installBtn.addEventListener('click', async () => {
        installBtn.classList.add('hidden');
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        // опционално: можеш да покажеш резултат на потребителя
        deferredPrompt = null;
      });
    }

    // Регистрирай статичен service worker /sw.js (трябва да съществува в root)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch((err) => {
        // silent fail
        console.warn('SW register failed', err);
      });
    }

    // NOTE: iOS селективно игнорира beforeinstallprompt; потребители трябва да използват "Share → Add to Home Screen"
  </script>
</body>
</html>
